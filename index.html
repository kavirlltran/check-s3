<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pronunciation Checker</title>
  <style>
    /* Global styles */
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    }
    .container {
      min-height: 100vh;
      background: linear-gradient(135deg, #1e3c72, #2a5298);
      color: #fff;
      padding: 20px;
      position: relative;
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .robot-image {
      width: 80px;
      height: 80px;
    }
    .content {
      margin-top: 30px;
    }
    .line-box {
      background: rgba(255, 255, 255, 0.1);
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 8px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
      transition: transform 0.3s, background 0.3s, box-shadow 0.3s;
      cursor: pointer;
    }
    /* Khi dòng được chọn, highlight luôn sáng với nền sáng hơn và hiệu ứng glow */
    .line-box.active {
      background: rgba(255, 255, 255, 0.3);
      transform: translateY(-5px);
      box-shadow: 0 0 15px rgba(255, 255, 255, 0.8);
    }
    .line-box:hover {
      background: rgba(255, 255, 255, 0.15);
    }
    .feedback {
      margin-top: 10px;
      background: rgba(0, 0, 0, 0.2);
      padding: 10px;
      border-radius: 5px;
      font-size: 0.9rem;
    }
    .controls {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      flex-direction: column;
      gap: 15px;
      z-index: 100;
      align-items: center;
    }
    button {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      background: #ff5722;
      color: #fff;
      font-size: 16px;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover:not(:disabled) {
      background: #e64a19;
    }
    button:disabled {
      background: #999;
      cursor: not-allowed;
    }
    .stress {
      color: #ffd700;
      font-weight: bold;
    }
    .mic-notice {
      font-size: 0.9rem;
      background: rgba(0, 0, 0, 0.3);
      padding: 8px 12px;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <!-- Load React, ReactDOM and Babel -->
  <script src="https://unpkg.com/react@17/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  
  <!-- Our React code -->
  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    // Các dòng nội dung với dấu ' chỉ các âm tiết được nhấn mạnh.
    const lines = [
      "We should ‘finish the ‘project for our ‘history ‘class",
      "‘Peter is re‘vising for his e‘xam ‘next ‘week.",
      "‘Students will ‘spend more ‘time ‘working with ‘other ‘classmates.",
      "I ‘like to ‘watch ‘videos that ‘help me ‘learn ‘new ‘things",
      "I have ‘installed some ‘apps on my ‘phone"
    ];

    function App() {
      const [activeLineIndex, setActiveLineIndex] = useState(null);
      const [feedbacks, setFeedbacks] = useState({});
      const [recording, setRecording] = useState(false);
      const [transcript, setTranscript] = useState("");
      const [micAccessMessage, setMicAccessMessage] = useState("");
      const recognitionRef = useRef(null);

      // Khởi tạo Web Speech API nếu có hỗ trợ
      useEffect(() => {
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        if (SpeechRecognition) {
          const recognition = new SpeechRecognition();
          recognition.continuous = true; // Lắng nghe liên tục cho đến khi dừng
          rec
